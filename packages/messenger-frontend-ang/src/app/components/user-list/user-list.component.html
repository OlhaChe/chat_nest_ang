<div class="user-list flex flex-col h-screen bg-secondary p-4 m-auto w-1/3">
  <h2 class="text-center text-2xl">Chats</h2>
  <ul class="divide-y divide-gray-200">
    <li *ngFor="let user of userWithChats"
        (click)="openChat(user.user.userId)">
      <div class="block hover:bg-gray-50">
        <div class="px-4 py-4 sm:px-6">
          <div class="flex items-center justify-between">
            <svg class="mr-1.5 size-5 shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
              <path d="M7 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM14.5 9a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM1.615 16.428a1.224 1.224 0 0 1-.569-1.175 6.002 6.002 0 0 1 11.908 0c.058.467-.172.92-.57 1.174A9.953 9.953 0 0 1 7 18a9.953 9.953 0 0 1-5.385-1.572ZM14.5 16h-.106c.07-.297.088-.611.048-.933a7.47 7.47 0 0 0-1.588-3.755 4.502 4.502 0 0 1 5.874 2.636.818.818 0 0 1-.36.98A7.465 7.465 0 0 1 14.5 16Z"></path>
            </svg>
            <div class="truncate text-sm text-indigo-400">{{ user.user.userName }}</div>
            <div *ngIf="user.lastMessage" class="ml-2 flex shrink-0">
              <span class="inline-flex items-center rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-green-600/20 ring-inset">{{ user.lastMessage.createdAt | timeAgo }}</span>
            </div>
          </div>
          <div class="mt-2 flex justify-between">
            <div class="sm:flex">
              <div *ngIf="user.lastMessage.message" class="mr-6 flex items-center text-sm text-gray-500">
                {{ truncate(user.lastMessage.message) }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </li>
  </ul>
  <div *ngIf="usersWithoutChats.length > 0 && userWithChats.length > 0" class="border-b-2">
    <h3 class="text-center text-l">New Chats</h3>
  </div>
  <ul class="divide-y divide-gray-200">
    <li *ngFor="let user of usersWithoutChats"
        (click)="openChat(user.userId)">
      <div class="block hover:bg-gray-50">
        <div class="px-4 py-4 sm:px-6">
          <div class="flex items-center">
            <svg class="mr-1.5 size-5 shrink-0 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
              <path d="M7 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM14.5 9a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM1.615 16.428a1.224 1.224 0 0 1-.569-1.175 6.002 6.002 0 0 1 11.908 0c.058.467-.172.92-.57 1.174A9.953 9.953 0 0 1 7 18a9.953 9.953 0 0 1-5.385-1.572ZM14.5 16h-.106c.07-.297.088-.611.048-.933a7.47 7.47 0 0 0-1.588-3.755 4.502 4.502 0 0 1 5.874 2.636.818.818 0 0 1-.36.98A7.465 7.465 0 0 1 14.5 16Z"></path>
            </svg>
            <div class="truncate text-sm text-indigo-800">{{ user.userName }}</div>
          </div>
        </div>
      </div>
    </li>
  </ul>
  <div *ngIf="usersWithoutChats.length === 0 && userWithChats.length === 0">
    <p>No chats available.</p>
  </div>

</div>
